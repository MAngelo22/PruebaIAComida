(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function i(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=i(n);fetch(n.href,r)}})();document.getElementById("uploadButton").addEventListener("click",()=>{document.getElementById("imageInput").click()});document.getElementById("imageInput").addEventListener("change",c);function c(t){const e=t.target.files[0],i=2*1024*1024;if(e&&e.size>i){alert("El archivo es demasiado grande. Selecciona uno de menos de 2 MB.");return}const o=new FileReader;o.onloadend=()=>{const n=o.result,r=document.getElementById("imagePreview");r.src=n,r.style.display="block",document.getElementById("sendButton").disabled=!1},o.readAsDataURL(e)}document.getElementById("cameraButton").addEventListener("click",async()=>{try{const t=await navigator.mediaDevices.getUserMedia({video:!0}),e=document.createElement("video");e.srcObject=t,e.play(),e.style.width="100%",e.style.maxWidth="300px",e.style.marginTop="10px",document.body.appendChild(e);const i=document.createElement("button");i.innerText="Capturar Foto",i.style.display="block",i.style.marginTop="10px",document.body.appendChild(i),i.addEventListener("click",()=>{const o=document.createElement("canvas");o.width=e.videoWidth,o.height=e.videoHeight,o.getContext("2d").drawImage(e,0,0,o.width,o.height);const r=o.toDataURL("image/png"),a=document.getElementById("imagePreview");a.src=r,a.style.display="block",document.getElementById("sendButton").disabled=!1,t.getTracks().forEach(d=>d.stop()),document.body.removeChild(e),document.body.removeChild(i)})}catch(t){console.error("Error al acceder a la cámara:",t),alert("No se puede acceder a la cámara. Revisa permisos y configuración.")}});document.getElementById("sendButton").addEventListener("click",()=>{const t=document.getElementById("imagePreview").src;t&&(l(),s(t))});async function s(t){try{const i=await(await fetch("http://localhost:3000/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageUrl:t})})).json();document.getElementById("result").innerHTML=i}catch(e){console.error("Error al analizar la imagen:",e),document.getElementById("result").innerText="Error al analizar la imagen."}finally{m()}}document.getElementById("openNavButton").addEventListener("click",function(){document.getElementById("sidebar").style.width="250px",document.getElementById("mainContent").style.marginLeft="250px"});document.getElementById("closeNavButton").addEventListener("click",function(){document.getElementById("sidebar").style.width="0",document.getElementById("mainContent").style.marginLeft="0"});function l(){const t=document.getElementById("existingSpinner");t&&(t.style.display="none"),document.getElementById("spinner").style.display="block"}function m(){document.getElementById("spinner").style.display="none";const t=document.getElementById("existingSpinner");t&&(t.style.display="block")}document.getElementById("mainContent").addEventListener("sendButton",async function(t){t.preventDefault();const e=document.getElementById("imageInput"),i=new FormData;i.append("image",e.files[0]);try{(await fetch("/analyze",{method:"POST",body:i})).ok?window.location.href="/resultado.html":alert("Error al analizar la imagen.")}catch(o){console.error("Error:",o),alert("Hubo un problema con la solicitud.")}});
